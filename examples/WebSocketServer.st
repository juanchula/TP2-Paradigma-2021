'From Pharo8.0.0 of 22 January 2020 [Build information: Pharo-8.0.0+build.1124.sha.0932da82f08175e906b0e2a8052120c823374e9f (64 Bit)] on 6 June 2021 at 6:25:37.711852 pm'!Object subclass: #WebSocketServer	instanceVariableNames: 'nroPuerto data html'	classVariableNames: ''	package: 'TP2-CryptoServer'!!WebSocketServer commentStamp: 'AlejandroFerrero 6/4/2021 16:58' prior: 0!Web Socket del lado del servidor.!!WebSocketServer methodsFor: 'initialization' stamp: 'JuanIgnacioFernandez 6/5/2021 20:46'!generarHtml: dict	! !!WebSocketServer methodsFor: 'initialization' stamp: 'JuanIgnacioFernandez 6/6/2021 18:02'!initialize		data := 'ESTO ES LO INICIAL'.		html := '<html><meta charset="utf-8" /><title>WebSocket Smalltalk Image Status Stream</title><body><pre id="data"></pre><script language="javascript" type="text/javascript">    var wsUri = "ws://" + location.host + "/ws-crypto-server";    var exampleSocket = new WebSocket(wsUri);    exampleSocket.onmessage = function(event) {		var el = document.body.querySelector("#data");		if(el){			el.textContent = event.data;		}		      }</script><h2>WebSocket Smalltalk Image Status Stream JUANCHULA</h2></body></html>'.! !!WebSocketServer methodsFor: 'initialization' stamp: 'JuanIgnacioFernandez 6/6/2021 18:17'!update: aDatadata := aData! !!WebSocketServer methodsFor: 'initialization' stamp: 'JuanIgnacioFernandez 6/6/2021 17:40'!value: webSocket	"I stream status messages to a WebSocket client, once every second 	until ConnectionClosed or no longer isConnected"		[ 		webSocket logGeneric: 'Started status streaming'.		[ 			webSocket sendMessage: self data.			1 second asDelay wait.			webSocket isConnected ] whileTrue ] 		on: ConnectionClosed 		do: [ webSocket logGeneric: 'Ignoring connection close' ].	webSocket logGeneric: 'Stopping status streaming' ! !!WebSocketServer methodsFor: 'initialization' stamp: 'JuanIgnacioFernandez 6/5/2021 21:02'!handleRequest: request   request uri path = 'crypto-server'      ifFalse: [ ^ ZnResponse notFound: request uri ].   ^ ZnResponse ok: (ZnEntity text: data).   "^ ZnResponse ok: (ZnEntity dictionary: data)"! !!WebSocketServer methodsFor: 'accessing' stamp: 'JuanIgnacioFernandez 6/6/2021 17:43'!html: anObject	html := anObject! !!WebSocketServer methodsFor: 'accessing' stamp: 'JuanIgnacioFernandez 6/5/2021 18:30'!data	^ data! !!WebSocketServer methodsFor: 'accessing' stamp: 'JuanIgnacioFernandez 6/5/2021 18:16'!data: anObject	data := anObject! !!WebSocketServer methodsFor: 'accessing' stamp: 'JuanIgnacioFernandez 6/6/2021 17:43'!html	^ html! !